# Домашнее задание
# iBGP

## Цель:
1. Настроить iBGP в офисе Москва
2. Настроить iBGP в сети провайдера Триада
3. Организовать полную IP связанность всех сетей


## Описание/Пошаговая инструкция выполнения домашнего задания:


1. Настроить iBGP в офисе Москва между маршрутизаторами R14 и R15.
2. Настроить iBGP в провайдере Триада, с использованием RR.
3. Настройть офиса Москва так, чтобы приоритетным провайдером стал Ламас.
4. Настройть офиса С.-Петербург так, чтобы трафик до любого офиса распределялся по двум линкам одновременно.
5. Все сети в лабораторной работе должны иметь IP связность.
6. План работы и изменения зафиксированы в документации.
Документация оформлена на github. (желательно использовать markdown).


Топология сети:

![](base_scheme.png)

## 1. Настроить iBGP в офисе Москва между маршрутизаторами R14 и R15.

1. Для того, чтобы настроить iBGP в офисе Москва между маршрутизаторами R14 и R15. Начнем на R14:

Так как должна быть одной AS в офисе Москвы на R14 и R15, то возял AS 64555. На R14 изначально была данная AS тогда просто добавим нового соседа с той же AS, так как она та же как и R14, то она станет iBGP
```
R14(config)#router bgp 64555
R14(config-router)#neighbor 192.168.14.42 remote-as 64555
```

2. На R15 удалим прошлую AS BGP и создадим AS 64555:
```
R15(config)#no router bgp 64550
R15(config)#router bgp 64555
R15(config-router)#neighbor 192.168.111.1 remote-as 64755
R15(config-router)#neighbor 192.168.14.41 remote-as 64755
R15(config-router)#network 192.168.14.0 mask 255.255.255.0
R15(config-router)#network 192.168.111.0 mask 255.255.255.252
```
3. Так же надо исправить соседа на R21 иначе будет ошибка:

Теперь надо настроить R21
```
R21(config)#router bgp 64755
R21(config-router)#no neighbor 192.168.111.2 remote-as 64550
R21(config-router)#neighbor 192.168.111.2 remote-as 64555
```
4. Настройка iBGP на роутерах R14 и R15 завершена.

## 2. Настроить iBGP в провайдере Триада, с использованием RR.

Чтобы настроить iBGP в провайдере Триада, с использованием RR, необходимо настроить BGP с одой AS R23,R25,R26.

1. Начнем с R23 и R22:

На R23:
```
R23(config)#router bgp 64855
R23(config-router)#neighbor 192.168.105.2 rem
R23(config-router)#neighbor 192.168.105.2 remot
R23(config-router)#neighbor 192.168.105.2 remote-as 64655
R23(config-router)#neighbor 192.168.1.6 remote-as 64855  
R23(config-router)#neighbor 192.168.1.2 remote-as 64855
```

На R22:
```
R22(config)#router bgp 64655
R22(config-router)#neighbor 192.168.105.1 remote-as 64855
```
На R25:
```
R25(config)#router bgp 64855
R25(config-router)#neighbor 192.168.1.1 remote-as 64855
R25(config-router)#neighbor 192.168.1.14 remote-as 64855
```
На R26:
```
R26(config)#router bgp 64855
R26(config-router)#neighbor 192.168.1.13 remote-as 64855
R26(config-router)#neighbor 192.168.1.9 remote-as 64855 
```

На R24 необходимо добавить соседа:
```
R24(config)#router bgp 64855
R24(config-router)#neighbor 192.168.1.10 remote-as 64855
```
2. Необходимо выбрать какие из роутеров в Триаде будут RR. Выбрал R24 и R23 так как они стоят на границе для провайдера Киторн и Ламас:

```

```